/*!
 * CodeNegar WooCommerce AJAX Product Filter 
 * WCPF: WooCommerce Product Filter
 *
 * Frontend Script File
 *
 * @package	WooCommerce AJAX Product Filter
 * @author	Farhad Ahmadi
 * @link	http://codenegar.com/go/wcpf
 * version	2.8.0
 */
function codenegar_addParameter(e,a,t,r){if(replaceDuplicates=!0,e.indexOf("#")>0){var n=e.indexOf("#");urlhash=e.substring(e.indexOf("#"),e.length)}else urlhash="",n=e.length;sourceUrl=e.substring(0,n);var o=sourceUrl.split("?"),c="";if(o.length>1)for(var i=o[1].split("&"),_=0;_<i.length;_++){var d=i[_].split("=");replaceDuplicates&&d[0]==a||(""==c?c="?":c+="&",c+=d[0]+"="+(d[1]?d[1]:""))}return""==c&&(c="?"),r?c="?"+a+"="+t+(c.length>1?"&"+c.substring(1):""):(""!==c&&"?"!=c&&(c+="&"),c+=a+"="+(t?t:"")),o[0]+c+urlhash}function codenegar_correct_cnep(e){return e.find("a[href]").each(function(){var e=jQuery(this).attr("href").replace(/cnep=0/g,"cnep=1");jQuery(this).attr("href",e)}),e}function codenegar_update_pagination(){var e=codenegar_wcpf_config.current_theme;return e.indexOf("stylemag")>-1?!0:e.indexOf("storefront")>-1?!1:e.indexOf("statement")>-1?!0:e.indexOf("goodstore")>-1?!1:e.indexOf("wpo shopping")>-1?!0:e.indexOf("adrenalin")>-1?!1:e.indexOf("buyshop")>-1?!1:0}function codenegar_encode_url(e){return e=e.replace(/,/g,"%2C")}function codenegar_add_overlay(e,a){if("yes"!=codenegar_wcpf_config.reload_entire_page){var t={bgColor:"#fff",opacity:codenegar_wcpf_config.ajax_overlay_opacity,duration:600,spinner:codenegar_wcpf_config.loader_img,wrap_id:"codenegar_ajax_loader",wrap_class:"codenegar-ajax-loader blockUI blockOverlay"};a=jQuery.extend(t,a),"transparent"==codenegar_wcpf_config.ajax_overlay_color&&(a.bgColor="transparent");var r=jQuery("<div></div>").css({"background-color":a.bgColor,opacity:a.opacity,width:"100%",height:"100%",top:"0px",left:"0px",cursor:"default","text-align":"center","z-index":99900,border:"none",margin:"0px",padding:"0px",border:"none","background-image":'url("'+a.spinner+'")',"background-position":"50% 50%","background-repeat":"no-repeat"}).attr("class",a.wrap_class).attr("id",a.wrap_id);"yes"==codenegar_wcpf_config.absolute_positioned_container&&(r.css("position","absolute"),e.css("position","relative")),"append"==codenegar_wcpf_config.ajax_overlay_style?e.append(r).fadeIn(a.duration):"prepend"==codenegar_wcpf_config.ajax_overlay_style?e.prepend(r).fadeIn(a.duration):"replace"==codenegar_wcpf_config.ajax_overlay_style&&e.html(r).fadeIn(a.duration)}}function codenegar_remove_overlay(e){e.children("#codenegar_ajax_loader").fadeOut("500",function(){jQuery(this).remove()})}function codenegar_format_range(e,a,t){var r=e;return r=r.replace("%s",a),r=r.replace("%e",t)}function codenegar_get_parameter(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+e+"=([^&#]*)",t=new RegExp(a),r=History.getState(),n=r.cleanUrl,o=t.exec(n);return null==o?"":o[1]}function wcpf_is_cat_cat_clicked(){var e=History.getState(),a="not",t=e.cleanUrl,r=t.substring(t.lastIndexOf("&")+1);return r.length>0&&r.indexOf("=")>-1&&(r=r.split("="),2==r.length&&"cat_cat"==r[0]&&(a=r[1])),parseInt(a)>0||"0"==a?!0:!1}function codenegar_wcpf_add_parameter(e,a,t,r){var n=History.getState(),o=n.cleanUrl,c="",i=e+"_"+t;"orderby_orderby"==i&&(i="orderby"),c=codenegar_addParameter(o,"cnpf","1",!0),c=codenegar_addParameter(c,"cnep","0"),c=codenegar_addParameter(c,i,r),(document.URL==codenegar_wcpf_config.home_url||document.URL==codenegar_wcpf_config.home_url+"/")&&(c=codenegar_addParameter(c,"post_type","product")),0==codenegar_page_title.length&&(codenegar_page_title=jQuery("title").text()),History.pushState({state:1},codenegar_page_title,c)}function codenegar_make_slider(e){var a=parseInt(e.closest(".codenegar_slider_wrapper").next().attr("data-min")),t=parseInt(e.closest(".codenegar_slider_wrapper").next().attr("data-max")),r=e.closest(".codenegar_slider_wrapper").next().attr("data-template"),n=e.closest(".codenegar_slider_wrapper").next().attr("data-widget"),o=e.closest(".codenegar_slider_wrapper").next().attr("data-type"),c=e.closest(".codenegar_slider_wrapper").next().attr("data-key"),i=parseInt(e.closest(".codenegar_slider_wrapper").next().attr("data-step"));current_values=codenegar_get_parameter(n+"_"+c);var _=0,d=0;1==parseInt(codenegar_get_parameter("cnpf"))&&current_values.length>0&&(current_values=current_values.split(","),2==current_values.length&&(_=parseInt(current_values[0]),d=parseInt(current_values[1]))),parseInt(_)>0||(_=a),parseInt(d)>0||(d=t),e.slider({range:!0,min:a,max:t,step:i,values:[_,d],create:function(a,t){e.closest(".codenegar_slider_wrapper").next().children(".min_value").val(_),e.closest(".codenegar_slider_wrapper").next().children(".max_value").val(d)},slide:function(a,t){e.closest(".codenegar_slider_wrapper").next().children(".min_value").val(t.values[0]),e.closest(".codenegar_slider_wrapper").next().children(".max_value").val(t.values[1]),e.closest(".codenegar_slider_wrapper").next().children(".amount").html(codenegar_format_range(r,t.values[0],t.values[1]))},change:function(e,a){if(e.originalEvent){var t=a.values[0]+","+a.values[1];codenegar_wcpf_add_parameter(n,o,c,t)}}}),e.closest(".codenegar_slider_wrapper").next().children(".amount").html(codenegar_format_range(r,_,d))}function update_filters_count(e){if("yes"==codenegar_wcpf_config.count_filter_items){var a=wcpf_is_cat_cat_clicked();e.find(".wcpf_updating_widget").each(function(){var e=jQuery(this),t=e.attr("id");return 1==a&&"wcpf_cat_cat_list"==t?!0:void jQuery("#"+t).hide().html(e.html()).fadeIn()})}}function codenegar_get_theme_custom_areas(){var e=codenegar_wcpf_config.current_theme;return e.indexOf("oxygen")>-1?"span.results":e.indexOf("buyshop")>-1?".wft_pagination, p.woocommerce-result-count:nth-child(2)":""}function codenegar_get_theme_selector(){var e=codenegar_wcpf_config.current_theme;if(e.indexOf("the retailer")>-1){if(jQuery(".listing_products").length>0)return".listing_products";if(jQuery(".listing_products_no_sidebar").length>0)return".listing_products_no_sidebar"}return e.indexOf("blanco")>-1?"#default_products_page_container":e.indexOf("simplicity")>-1?"#contentarea .grid_9":e.indexOf("flatsome")>-1?"div.large-9":e.indexOf("foxy")>-1?"div#et_results_settings":e.indexOf("mr. tailor")>-1?"ul.products":e.indexOf("the7.2")>-1?"div#content":e.indexOf("storefront")>-1?".site-main":e.indexOf("wpo shopping")>-1?".products":e.indexOf("goodstore")>-1?".archive-content":e.indexOf("adrenalin")>-1?".product-listing-wrapper":e.indexOf("oxygen")>-1?".shop-grid":e.indexOf("buyshop")>-1?".span9":""}function wcpf_auto_override_selector(){var e=codenegar_wcpf_config.current_theme;return e.indexOf("flatsome")>-1&&0==jQuery(".codenegar-shop-loop-wrapper ul").length?!0:!1}function hide_empty_widgets(){"yes"==codenegar_wcpf_config.hide_empty_widgets&&(jQuery(".wcpf_updating_widget ul").each(function(){var e=jQuery(this),a=parseInt(e.children("li").size());0==a?e.parents(".wcpf_master_wrap").hide():e.parents(".wcpf_master_wrap").show()}),jQuery(".wcpf_updating_widget select").each(function(){var e=jQuery(this),a=parseInt(e.children("option").size());0==a?e.parents(".wcpf_master_wrap").hide():e.parents(".wcpf_master_wrap").show()}))}function wcpf_get_main_ul(){if(jQuery("ul.products").length>0)return"ul.products";if(jQuery("ul#products").length>0)return"ul#products";var e=-1,a="";return jQuery("ul").not(".ab-top-menu, .nav, .ab-submenu, #sidebar ul, .sidebar ul").not("nav ul").not("aside ul").not("ul[role='navigation']").not(".codenegar_product_filter_wrap  ul").each(function(){jQuery(this).width()>e&&(a=this,e=jQuery(this).width())}),"string"==typeof a&&a.length>0?a:a=jQuery(".woocommerce-ordering").next()}var codenegar_page_title="";jQuery(function(){jQuery(".range_meta_slider").each(function(){codenegar_make_slider(jQuery(this))}),codenegar_page_title=jQuery("title").text(),jQuery("a.codenegar_product_filter_reset_button").live("click",function(e){e.preventDefault(),$this=jQuery(this);var a=$this.attr("data-url");if(a=codenegar_addParameter(a,"cnpf","1"),a=codenegar_addParameter(a,"cnep","0"),0==codenegar_page_title.length&&(codenegar_page_title=jQuery("title").text()),parseInt(codenegar_get_parameter("cat_cat"))>0||"0"==parseInt(codenegar_get_parameter("cnpf"))){var t=codenegar_get_parameter("cat_cat"),r=jQuery('.codenegar_product_filter_wrap ul li.codenegar_applied_filter_cat a[data-old-value="'+t+'"]').attr("data-value");a=codenegar_addParameter(a,"cat_cat",r)}jQuery(".range_meta_slider").each(function(){$this=jQuery(this);var e=parseInt($this.closest(".codenegar_slider_wrapper").next().attr("data-min")),a=parseInt($this.closest(".codenegar_slider_wrapper").next().attr("data-max")),t=$this.closest(".codenegar_slider_wrapper").next().attr("data-template");$this.slider("values",[e,a]),$this.closest(".codenegar_slider_wrapper").next().children(".amount").html(codenegar_format_range(t,e,a))}),jQuery(".codenegar_product_filter_wrap select option:first-child").each(function(){jQuery(this).attr("selected","selected")}),History.pushState({state:1},codenegar_page_title,a);var n="codenegar_applied_filter chosen";"function"==typeof wcpf_chosen_class&&(n=wcpf_chosen_class()),jQuery(".codenegar_product_filter_wrap ul li").removeClass(n)}),jQuery(".codenegar_product_filter_wrap ul li a").live("click",function(e){e.preventDefault();var a=jQuery(this),t="codenegar_applied_filter chosen";"function"==typeof wcpf_chosen_class&&(t=wcpf_chosen_class()),"cat"==a.attr("data-key")&&"cat"==a.attr("data-widget")&&a.closest("li").siblings().removeClass(t),a.closest("li").toggleClass(t);var r=a.attr("data-widget"),n=a.attr("data-type"),o=a.attr("data-key"),c=a.attr("data-value"),i=r+"_"+o,_=codenegar_get_parameter(i);_=""!=_&&"cat_cat"!=i?_.split(","):[];var d=jQuery.inArray(c,_);d>-1?_.splice(d,1):_.push(c),new_value=_.join(","),"cat_cat"==i&&codenegar_get_parameter("cat_cat")==new_value&&(new_value=""),codenegar_wcpf_add_parameter(r,n,o,new_value)}),jQuery(".codenegar_product_filter_wrap select").live("change",function(){var e=jQuery("option:selected",this),a=e.attr("data-widget"),t=e.attr("data-type"),r=e.attr("data-key"),n=e.val();codenegar_wcpf_add_parameter(a,t,r,n)});var e=History.getState(),a=e.cleanUrl,t=!(!window.history||!history.pushState),r=!(-1==a.indexOf("#?")),n=!(-1==a.indexOf("cnpf"));!t&&r&&n&&(a=a.replace("#?","?"),0==codenegar_page_title.length&&(codenegar_page_title=jQuery("title").text()),History.pushState({state:1},codenegar_page_title,a))}),function(e,a){var t=e.History;return t.enabled?void t.Adapter.bind(e,"statechange",function(){var a=t.getState(),r=".codenegar-shop-loop-wrapper",n=jQuery(".codenegar-shop-loop-wrapper");0==n.length&&(r=wcpf_get_main_ul(),n=jQuery(r)),codenegar_get_theme_selector().length>0&&(n=jQuery(codenegar_get_theme_selector()),r=codenegar_get_theme_selector()),wcpf_auto_override_selector()&&(n=jQuery(codenegar_get_theme_selector()),r=codenegar_get_theme_selector()),codenegar_wcpf_config.wrapper_selector.length>0&&(n=jQuery(codenegar_wcpf_config.wrapper_selector),r=codenegar_wcpf_config.wrapper_selector),"yes"==codenegar_wcpf_config.reload_entire_page&&(e.location.href=a.cleanUrl),codenegar_add_overlay(jQuery(r),{}),"function"==typeof wcsl_before_ajax&&wcsl_before_ajax(),"function"==typeof wcpf_before_ajax&&wcpf_before_ajax(),jQuery.get(codenegar_encode_url(a.cleanUrl),function(e){var t=jQuery(e),o=t.find(r);o.length>0?n.hide().html(o.html()).fadeIn():"yes"==codenegar_wcpf_config.display_no_products_message&&n.hide().html(codenegar_wcpf_config.no_products_message).fadeIn(),0==t.find(r).children(".codenegar-shop-pagination-wrapper").length&&jQuery(".codenegar-shop-pagination-wrapper").hide().html(t.find(".codenegar-shop-pagination-wrapper")).fadeIn(),0==t.find(r).children(".woocommerce-result-count").length&&jQuery(".woocommerce-result-count").hide().html(t.find(".woocommerce-result-count")).fadeIn();var c=".pagination, .page-links, .paginator, .woo-pagination, .woocommerce-pagination, .emm-paginate, .wp-pagenavi, .pagination-wrapper, .general-pagination, .template-pagination",i=0==t.find(".codenegar-shop-loop-wrapper").children(c).length||codenegar_update_pagination();if(codenegar_update_pagination()===!1&&(i=!1),"function"==typeof wcpf_update_pagination&&(i=wcpf_update_pagination()),i){var _=t.find(c);_=codenegar_correct_cnep(_),jQuery(c).hide().html(_).fadeIn()}if(i&&"yes"==codenegar_wcpf_config.hide_duplicate_pagination){var d=c+":nth-child(2)";d=d.replace(/,/g,":nth-child(2),"),jQuery(d).hide()}var l=0,p=a.cleanUrl,s=p.substring(p.lastIndexOf("&")+1);if(s.length>0&&s.indexOf("=")>-1&&(s=s.split("="),2==s.length&&"cat_cat"==s[0]&&(l=s[1])),parseInt(l)>0||"0"==l){var g=jQuery(".codenegar_product_filter_wrap ul li a[data-value="+l+"]").closest(".codenegar_product_filter_wrap"),u=t.find(".codenegar_product_filter_wrap ul li a[data-old-value="+l+"]").closest(".codenegar_product_filter_wrap").children();u.length>0&&g.hide().html(u).fadeIn()}if(update_filters_count(t),hide_empty_widgets(),"function"==typeof wcsl_on_update||"function"==typeof wcpf_on_update){var f=[];f="function"==typeof wcpf_on_update?wcpf_on_update():wcsl_on_update();for(var f=wcsl_on_update(),h=f.length,w=0;h>w;w++){var y=f[w],m=t.find(y).html();m&&m.length>0?jQuery(y).hide().html(m).fadeIn():jQuery(y).hide().html("")}}var v=codenegar_get_theme_custom_areas();if(v.length>0)for(var f=codenegar_get_theme_custom_areas().split(","),h=f.length,w=0;h>w;w++){var y=f[w],m=t.find(y).html();m&&m.length>0?jQuery(y).hide().html(m).fadeIn():jQuery(y).hide().html("")}if(codenegar_wcpf_config.custom_areas.length>0)for(var f=codenegar_wcpf_config.custom_areas.split(","),h=f.length,w=0;h>w;w++){var y=f[w],m=t.find(y).html();m&&m.length>0?jQuery(y).hide().html(m).fadeIn():jQuery(y).hide().html("")}}).done(function(){codenegar_remove_overlay(jQuery(r)),"yes"==codenegar_wcpf_config.scroll_to_top&&jQuery(r).ScrollTo(),"function"==typeof wcsl_ajax_done&&wcsl_ajax_done(),"function"==typeof wcpf_ajax_done&&wcpf_ajax_done()}).fail(function(){"function"==typeof wcsl_ajax_fail&&wcsl_ajax_fail(),"function"==typeof wcpf_ajax_fail&&wcpf_ajax_fail(),n.hide().html(codenegar_wcpf_config.no_products_message).fadeIn()}).always(function(){"function"==typeof wcsl_after_ajax&&wcsl_after_ajax(),"function"==typeof wcpf_after_ajax&&wcpf_after_ajax()})}):!1}(window),function(e){e(document).ready(function(){e(function(){jQuery("select.orderby").live("change",function(){jQuery(this).hasClass("codenegar_product_filter_orderby")||jQuery(this).closest("form").submit()})})})}(jQuery);